<!DOCTYPE html>
<html lang="ru-Ru">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta charset="utf-8" />
<script type="text/javascript" language="JavaScript">
var MD5 = function(stringToEncode) {
	stringToEncode = unescape(encodeURIComponent(stringToEncode));
	result = EncToHex(V(Y(X(stringToEncode), 8 * stringToEncode.length)));
	return result.toLowerCase();
};
 
function EncToHex(data) {
	for (var symbol, hexDigits = "0123456789ABCDEF", res = "", counter = 0; counter < data.length; counter++) {
		symbol = data.charCodeAt(counter);
		res += hexDigits.charAt(symbol >>> 4 & 15) + hexDigits.charAt(15 & symbol);
	}
	return res;
}
 
function X(d) {
	for (var _ = Array(d.length >> 2), m = 0; m < _.length; m++) _[m] = 0;
	for (m = 0; m < 8 * d.length; m += 8) _[m >> 5] |= (255 & d.charCodeAt(m / 8)) << m % 32;
	return _
}
 
function V(d) {
	for (var result = "", m = 0; m < 32 * d.length; m += 8) result += String.fromCharCode(d[m >> 5] >>> m % 32 & 255);
	return result
}

function Y(d, x) {
	d[x >> 5] |= 128 << x % 32, d[14 + (x + 64 >>> 9 << 4)] = x;
	for (var m = 1732584193, f = -271733879, r = -1732584194, i = 271733878, n = 0; n < d.length; n += 16) {
		var h = m,
			t = f,
			g = r,
			e = i;
		f = md5_ii(f = md5_ii(f = md5_ii(f = md5_ii(f = md5_hh(f = md5_hh(f = md5_hh(f = md5_hh(f = md5_gg(f = md5_gg(f = md5_gg(f = md5_gg(f = md5_ff(f = md5_ff(f = md5_ff(f = md5_ff(f, r = md5_ff(r, i = md5_ff(i, m = md5_ff(m, f, r, i, d[n + 0], 7, -680876936), f, r, d[n + 1], 12, -389564586), m, f, d[n + 2], 17, 606105819), i, m, d[n + 3], 22, -1044525330), r = md5_ff(r, i = md5_ff(i, m = md5_ff(m, f, r, i, d[n + 4], 7, -176418897), f, r, d[n + 5], 12, 1200080426), m, f, d[n + 6], 17, -1473231341), i, m, d[n + 7], 22, -45705983), r = md5_ff(r, i = md5_ff(i, m = md5_ff(m, f, r, i, d[n + 8], 7, 1770035416), f, r, d[n + 9], 12, -1958414417), m, f, d[n + 10], 17, -42063), i, m, d[n + 11], 22, -1990404162), r = md5_ff(r, i = md5_ff(i, m = md5_ff(m, f, r, i, d[n + 12], 7, 1804603682), f, r, d[n + 13], 12, -40341101), m, f, d[n + 14], 17, -1502002290), i, m, d[n + 15], 22, 1236535329), r = md5_gg(r, i = md5_gg(i, m = md5_gg(m, f, r, i, d[n + 1], 5, -165796510), f, r, d[n + 6], 9, -1069501632), m, f, d[n + 11], 14, 643717713), i, m, d[n + 0], 20, -373897302), r = md5_gg(r, i = md5_gg(i, m = md5_gg(m, f, r, i, d[n + 5], 5, -701558691), f, r, d[n + 10], 9, 38016083), m, f, d[n + 15], 14, -660478335), i, m, d[n + 4], 20, -405537848), r = md5_gg(r, i = md5_gg(i, m = md5_gg(m, f, r, i, d[n + 9], 5, 568446438), f, r, d[n + 14], 9, -1019803690), m, f, d[n + 3], 14, -187363961), i, m, d[n + 8], 20, 1163531501), r = md5_gg(r, i = md5_gg(i, m = md5_gg(m, f, r, i, d[n + 13], 5, -1444681467), f, r, d[n + 2], 9, -51403784), m, f, d[n + 7], 14, 1735328473), i, m, d[n + 12], 20, -1926607734), r = md5_hh(r, i = md5_hh(i, m = md5_hh(m, f, r, i, d[n + 5], 4, -378558), f, r, d[n + 8], 11, -2022574463), m, f, d[n + 11], 16, 1839030562), i, m, d[n + 14], 23, -35309556), r = md5_hh(r, i = md5_hh(i, m = md5_hh(m, f, r, i, d[n + 1], 4, -1530992060), f, r, d[n + 4], 11, 1272893353), m, f, d[n + 7], 16, -155497632), i, m, d[n + 10], 23, -1094730640), r = md5_hh(r, i = md5_hh(i, m = md5_hh(m, f, r, i, d[n + 13], 4, 681279174), f, r, d[n + 0], 11, -358537222), m, f, d[n + 3], 16, -722521979), i, m, d[n + 6], 23, 76029189), r = md5_hh(r, i = md5_hh(i, m = md5_hh(m, f, r, i, d[n + 9], 4, -640364487), f, r, d[n + 12], 11, -421815835), m, f, d[n + 15], 16, 530742520), i, m, d[n + 2], 23, -995338651), r = md5_ii(r, i = md5_ii(i, m = md5_ii(m, f, r, i, d[n + 0], 6, -198630844), f, r, d[n + 7], 10, 1126891415), m, f, d[n + 14], 15, -1416354905), i, m, d[n + 5], 21, -57434055), r = md5_ii(r, i = md5_ii(i, m = md5_ii(m, f, r, i, d[n + 12], 6, 1700485571), f, r, d[n + 3], 10, -1894986606), m, f, d[n + 10], 15, -1051523), i, m, d[n + 1], 21, -2054922799), r = md5_ii(r, i = md5_ii(i, m = md5_ii(m, f, r, i, d[n + 8], 6, 1873313359), f, r, d[n + 15], 10, -30611744), m, f, d[n + 6], 15, -1560198380), i, m, d[n + 13], 21, 1309151649), r = md5_ii(r, i = md5_ii(i, m = md5_ii(m, f, r, i, d[n + 4], 6, -145523070), f, r, d[n + 11], 10, -1120210379), m, f, d[n + 2], 15, 718787259), i, m, d[n + 9], 21, -343485551), m = safe_add(m, h), f = safe_add(f, t), r = safe_add(r, g), i = safe_add(i, e)
	}
	return Array(m, f, r, i)
}

function md5_cmn(d, x, m, f, r, i) {
	return safe_add(bit_rol(safe_add(safe_add(x, d), safe_add(f, i)), r), m);
}

function md5_ff(d, x, m, f, r, i, n) {
	return md5_cmn(x & m | ~x & f, d, x, r, i, n);
}
 
function md5_gg(d, x, m, f, r, i, n) {
	return md5_cmn(x & f | m & ~f, d, x, r, i, n);
}
 
function md5_hh(d, x, m, f, r, i, n) {
	return md5_cmn(x ^ m ^ f, d, x, r, i, n);
}
 
function md5_ii(d, x, m, f, r, i, n) {
	return md5_cmn(m ^ (x | ~f), d, x, r, i, n);
}
 
function safe_add(a, b) {
	var c = (65535 & a) + (65535 & b);
	return (a >> 16) + (b >> 16) + (c >> 16) << 16 | 65535 & c;
}
 
function bit_rol(n, bits) {
	return n << bits | n >>> 32 - bits;
}
</script>

<script type="text/javascript" language="JavaScript">

MD5_CheckAndCount = function(){
	var str = document.getElementById("tg_acc").value.toLowerCase();
	var regexpTg = /^(@|(https:\/\/)?t.me\/)([a-z0-9_]{5,32})$/;
	var regexpTgQuest = /^[a-z0-9_]{5,32}$/;
	var regexpPhone = /^(\+7|8)(\s?\(?\d{3}\)?\s?(\d{3}[\s\-]?\d{2}[\s\-]?\d{2}|\d{4}[\s\-]?\d{3}))$/;

	document.getElementById("md5_text").value = "";

	if (regexpTg.test(str)) {
		var x = regexpTg.exec(str);
		document.getElementById("md5_text").value = MD5('@'+x[3]);
		navigator.clipboard.writeText(document.getElementById("md5_text").value);
		alert("Hash код скопирован в буфер обмена");
		return;
	} else if (regexpPhone.test(str)) {
		if (confirm("Вы ввели номер телефона. Возможно это ошибка. Вы уверены, что телеграм-аккаунт, который вы имеете в виду не имеет символьной ссылки (username)?")){
			var x = regexpPhone.exec(str);
			document.getElementById("md5_text").value = MD5('+7'+x[2].replace(/[\-\s\(\)]/g,''));
			navigator.clipboard.writeText(document.getElementById("md5_text").value);
			alert("Hash код скопирован в буфер обмена");
			return;
		} 
	} else {
		alert("Ошибка в поле ввода. Необходимо ввести ссылку на телеграм-аккаунт (usernamе) или номер телефона, если username отсутствует. Username начинается с @ или https://t.me/");
	}
}
</script>
</head>

<body>
<h2>Тут можно посчитать hash-код для телеграм аккаунта</h2>
<h5><i>Эта страница создана специально для исследования по оценке численности трансгендерных и небинарных людей в Санкт-Петербурге и Ленинградской области.</i></h5>

<h3>Генератор хэш-кода:</h3>
<p><b>Вставлять сюда:</b><input type="text" id="tg_acc" style="width: 250px;" /></p>
<p><b>Нажимать сюда:</b><input type="submit" value="Сгенерировать хэш-код" onclick="MD5_CheckAndCount()" /></p>
<p><b>Хэш код посмотреть можно тут: </b><input type="text" id="md5_text" style="width: 250px;" disabled /></p>

<h3>Небольшой дисклеймер</h3>
<p>Эта страница генерирует hash-код по данным аккаунта в телеграме для его анонимизации. Эта информация нужна исключительно для статистической обработки данных и не несёт в себе прямой ссылки на аккаунт. Задача hash-кода зашифровать данные таким образом, чтобы данные однозначно соответсвовали коду, однако обратная расшифровка исходных данных была бы невозможна без полного перебора всех возможных вариантов (что, хоть теоретически и возможно, однако крайне ресурсоёмко и требует огромных вычислительных мощностей, что делает задачу расшифровки бессмысленной). </p>
<p>Эта страница не передаёт никуда никакие данные, поэтому вам придется самостоятельно вставить ссылку на аккаунт и потом скопировать полученный hash-код в форму опроса, страничка лишь автоматически скопирует hash-код в буфер обмена, чтобы немного облегчить вам жизнь.</p>
<p>Весь код страницы написан в человекочитаемом виде, общим текстом, без разбивки на разные подгружаемые файлы, так чтобы при желании и умении вы могли легко убедиться в отсутствии скрытых эффектов и передаче куда-либо информации</p>
<p>Если у вас есть вопросы или вы обнаружили ошибку, напишите в телеграм <a href="https://t.me/kate_messorosh">@kate_messorosh</a>

<h3>Инструкция. Как найти символьную ссылку (username) на аккаунт в Телеграм</h3>
<p>На страничке чата с человеком нажмите на верхнюю плашку с именем пользователя<br />
<img src="./step1.jpg" style="width: 200px" />
</p>
<p>Если вы видите блок с симоволом <b>@</b> и дальше всякими буквами-цифрами, то нажимайте туда (ссылка сама скопируется в буфер)<br />
<img src="./step2.jpg" style="width: 200px"/>
</p>
<p>Если блока с симовольно ссылкой нет (<b>@something</b>), но есть номер телефона, то скопируйте его (можно просто нажать и выбрать соответсвующий пункт в выпадающем меню)<br />
<img src="./step3.jpg" style="width: 200px"/>
<p>Если в аккаунте нет ни username-ссылки ни телефона, то такой аккаунт нам не подходит. Имя пользователя в шапке аккаунта копировать НЕ НУЖНО</p>


</body>
</html>
